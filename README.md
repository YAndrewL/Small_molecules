# Protein-ligand binding sites prediction
This is a code repo for predicting ligand-binding sites of a given protein sequence. 
## Files and folders description
### 1. Raw data
This folder contains raw data. 

The first line is the protein id (which might not be PDB ID); the second line is the protein sequence, and the third line is the data label indicating binding sites or non-binding sites.

Note: if you wanna find the original data in PDB format, please kindly refer to the following 3 papers: [PUResNet](https://jcheminf.biomedcentral.com/articles/10.1186/s13321-021-00547-7), [P2Rank](https://jcheminf.biomedcentral.com/articles/10.1186/s13321-018-0285-8), and [GraphBind](https://academic.oup.com/nar/article/49/9/e51/6134185?login=true). The definition of binding sites could be slightly different due to different criteria, the files in Raw data are generated according to the setting in GraphBind. 

In this project, we used SCPDB as the training set, JOINED as the validation set and COACH420 as the testing set. 

### 2. Dataset
This folder contains data in .pkl format, and the embeddings were generated by ESM-2. 

### 3. triplet_classification
This fold contains a trained weights file. 

## Codes description
The training and implementation of this project are based on PyTorch and PyTorch-lightning 1.8.1, the higher version might not be compatible. Please refers to https://github.com/YAndrewL/CLAPE, the repo that holds CLAPE for inference code writing.

### 1. data.py
Implementation of datasets class.

### 2. model.py
Implementation of backbone models such as CNN, RNN and MLP.

### 3. losses.py
Implementation of several customized loss functions such as Triplet loss, TCL, and CrossEntropy, and the reference was described in the code comments. 

### 4. triplet.py
Implementation of the total training setting, please kindly refer to the document of PyTorch-lightning for details. (1.8.1)

### 5. pre.ipynb
The notebook for generating protein sequence embeddings, ESM-2 and ProtBert were provided.

### 6. test.ipynb
The notebook for obtaining metrics of testing set.


